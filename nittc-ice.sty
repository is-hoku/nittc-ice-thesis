\usepackage[top=1.20in,bottom=0.95in,left=0.59in,right=0.59in,headheight=0.28in,headsep=0.42in]{geometry}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{multirow}
\usepackage{tabularx}
\usepackage{color}
\usepackage{textcomp}
\usepackage{tipa}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{amsxtra}
\usepackage{wasysym}
\usepackage{isomath}
\usepackage{mathtools}
\usepackage{txfonts}
\usepackage{upgreek}
\usepackage{enumerate}
\usepackage{tensor}
\usepackage{pifont}
% イタリック体がアンダーラインにならないようにする
\usepackage[normalem]{ulem}
\usepackage{xfrac}
\usepackage{arydshln}
\usepackage{coffeestains}
\definecolor{red}{rgb}{1,0,0}

\usepackage{luatexja-fontspec}
% 欧文文字のフォントは「Times New Roman」指定
\setmainfont[Ligatures={Rare,TeX}]{Times-New-Roman}
\setsansfont{Arial}
% 和文文字のフォントは「MS 明朝」指定
\setmainjfont[
    YokoFeatures       = {JFM=jlreq},
    TateFeatures       = {JFM=jlreqv},
    BoldFont           = MS-Mincho,
    BoldFeatures       = {FakeBold=2},
    ItalicFont         = MS-Mincho,
    ItalicFeatures     = {FakeSlant=0.33},
    BoldItalicFont     = MS-Mincho,
    BoldItalicFeatures = {FakeBold=2, FakeSlant=0.33}
]{MS-Mincho}
\setsansjfont[
    YokoFeatures       = {JFM=jlreq},
    TateFeatures       = {JFM=jlreqv},
    BoldFont           = MS-Gothic,
    BoldFeatures       = {FakeBold=2},
    ItalicFont         = MS-Gothic,
    ItalicFeatures     = {FakeSlant=0.33},
    BoldItalicFont     = MS-Gothic,
    BoldItalicFeatures = {FakeBold=2, FakeSlant=0.33}
]{MS-Gothic}
% URL のフォントは等幅フォントにしない
\urlstyle{same}
\usepackage{setspace}
\usepackage{caption}
% キャプションのフォントはミディアム
\captionsetup[figure]{font=md}
% キャプションをページ全体での連番にする
\counterwithout{figure}{chapter}
\counterwithout{figure}{section}
% キャプションと参照時の名前の設定
\renewcommand{\figurename}{}
\renewcommand{\thefigure}{図\arabic{figure}}
% キャプションのフォントはミディアム
\captionsetup[table]{font=md}
% キャプションをページ全体での連番にする
\counterwithout{table}{chapter}
\counterwithout{table}{section}
% キャプションと参照時の名前の設定
\renewcommand{\tablename}{}
\renewcommand{\thetable}{表\arabic{table}}
% カラムを自動調整 (X) かつ中央揃え (c)
\newcolumntype{Y}{>{\centering\arraybackslash}X}

\usepackage{unicode-math}
\setmathfont{Cambria-Math}

% ヘッダ 8bp
\newcommand{\header}[1]{\fontsize{8bp}{10bp}\selectfont#1}
% タイトル 16bp 中央揃え
\renewcommand{\title}[1]{\fontsize{16bp}{22bp}\selectfont\centering#1}
% サブタイトルタイトル 14bp 中央揃え
\newcommand{\subtitle}[1]{\fontsize{14bp}{18bp}\selectfont\centering －#1－}
% 筆者 12bp 中央揃え (研究室 名前)を入力
\renewcommand{\author}[2]{\fontsize{12bp}{18bp}\selectfont\centering\vspace{0.3\baselineskip}#1\vspace{0.5\baselineskip}\hspace{1.5em}#2}
% あらまし
\renewcommand{\abstract}[1]{\textbf{あらまし}\quad #1}
% キーワード
\newcommand{\keyword}[1]{\textbf{キーワード}\quad #1\newline}
% 章 行間はWordデフォルト 改ページしない 12bp 太字
\ModifyHeading{chapter}{
lines=1.15,
allowbreak_if_evenpage=false,
pagebreak=nariyuki,
font=\fontsize{12bp}{16bp}\selectfont\bfseries,
label_format={\thechapter.},
}
% 節 行間はWordデフォルト 改ページしない 10.5bp 太字
\ModifyHeading{section}{
lines=1.15,
allowbreak_if_evenpage=false,
pagebreak=nariyuki,
font=\fontsize{10.5bp}{16bp}\selectfont\bfseries,
label_format={\thesection.},
}
% 小節 行間はWordデフォルト 改ページしない 太字
\ModifyHeading{subsection}{
lines=1.15,
allowbreak_if_evenpage=false,
pagebreak=nariyuki,
font=\selectfont\bfseries,
label_format={\thesubsection.},
}
% 小小節 行間はWordデフォルト 改ページしない 太字
\ModifyHeading{subsubsection}{
lines=1.15,
allowbreak_if_evenpage=false,
pagebreak=nariyuki,
font=\selectfont\bfseries,
label_format={\thesubsubsection.},
}

% ヘッダ設定
\usepackage{titleps}
\newpagestyle{header}{
  \sethead
  {\parbox{0.9\textwidth}{\header{
   \ \ 豊田工業高等専門学校　情報工学科\\
   \ \ Department of Information and Computer Engineering,\\
   \ \ National Institute of Technology, Toyota College
   }}}
  {}
  {\parbox{\textwidth}{\header{
   卒業論文\\
   Graduation Thesis\\
   February 22, \the\year % 日にちは都度変更する必要有り
   }}}
   \setfoot
   {}
   {\thepage}
   {}
}

% 参考文献の見出しを「文献」に変更
\renewcommand{\refname}{%
{\fontsize{10.5bp}{16bp}\selectfont\bfseries\centering{文\ \ \ \ \ \ 献}\par}
}
% ヘッダとフッタの bibliography を削除
\renewcommand{\markboth}[2]{}

% 謝辞
\newcommand{\acknowledgement}{%
	{\fontsize{10.5bp}{16bp}\selectfont\bfseries\centering{謝\ \ \ \ \ \ 辞}\par}
}

% 1 ページ目以外はフッタのページ数のみ
\pagestyle{plain}

% ソースコードの記述設定
\usepackage{sourcecodepro}
\usepackage{listings,xcolor}
\lstset{
	basicstyle = {\ttfamily\small},
	identifierstyle={\color[HTML]{24292E}},
	commentstyle={\color[HTML]{6A737D}},
	keywordstyle={\color[HTML]{D73A49}},
	ndkeywordstyle={\color[HTML]{005CC5}},
	stringstyle={\color[HTML]{032F62}},
	frame = {tbrl},
	breaklines = true,
	numbers = left,
	showspaces = false,
	showstringspaces = false,
	showtabs = false,
	captionpos = t,
}
\captionsetup[lstlisting]{font=md}
\AtBeginDocument{%
% キャプションをページ全体での連番にする
\counterwithout{lstlisting}{chapter}
\counterwithout{lstlisting}{section}
% キャプションと参照時の名前の設定
\renewcommand{\lstlistingname}{}
\renewcommand{\thelstlisting}{ソースコード\arabic{lstlisting}}
}

% 数式番号をページ全体での連番にする
\counterwithout{equation}{chapter}
\counterwithout{equation}{section}

% 参考文献の参照時の記号を上付きにする
\usepackage[super]{cite}
\renewcommand\citeform[1]{[#1]}
